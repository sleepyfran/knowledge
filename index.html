<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.101.0"><title>sleepyfran's blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://sleepyfran.github.io/blog/><link rel=stylesheet href=https://sleepyfran.github.io/blog/assets/style.css><link rel=stylesheet href=https://sleepyfran.github.io/blog/assets/ruber.css><link rel=apple-touch-icon href=https://sleepyfran.github.io/blog/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://sleepyfran.github.io/blog/img/favicon/ruber.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="sleepyfran's blog"><meta property="og:description" content><meta property="og:url" content="https://sleepyfran.github.io/blog/"><meta property="og:site_name" content="sleepyfran's blog"><meta property="og:image" content="https://sleepyfran.github.io/blog/img/favicon/ruber.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><link href=/blog/index.xml rel=alternate type=application/rss+xml title="sleepyfran's blog"></head><body class=ruber><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=https://sleepyfran.github.io/blog><div class=logo>sleepyfran's blog</div></a></div></div></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=https://sleepyfran.github.io/blog/posts/swiftui-coredata-objectatindex-error/>SwiftUI with CoreData: objectAtIndex unrecognized error</a></h1><div class=post-meta><span class=post-date>2022-06-21</span>
<span class=post-author>:: sleepyfran</span></div><span class=post-tags>#<a href=https://sleepyfran.github.io/blog/tags/swift/>swift</a>&nbsp;
#<a href=https://sleepyfran.github.io/blog/tags/swiftui/>swiftui</a>&nbsp;
#<a href=https://sleepyfran.github.io/blog/tags/coredata/>coredata</a>&nbsp;
#<a href=https://sleepyfran.github.io/blog/tags/gotcha/>gotcha</a>&nbsp;</span><div class=post-content><p>Ah, if it isn&rsquo;t those awesome errors that make it fun to work with SwiftUI! So
in retrospective this one makes sense, but if you&rsquo;re like me who&rsquo;s just starting
out with CoreData and SwiftUI this error makes zero sense.</p><p>In essence I was getting this error when trying to do something like this:</p><pre tabindex=0><code>2022-06-21 22:41:30.447763+0200 App[56115:1179524] -[__NSCFSet objectAtIndex:]: unrecognized selector sent to instance 0x600003df9c20
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>CoreData</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>SwiftUI</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>BudgetView</span>: View {
</span></span><span style=display:flex><span>    @FetchRequest(entity: CategoryGroup.entity(), sortDescriptors: [])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> categoryGroups: FetchedResults&lt;CategoryGroup&gt;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> body: some View {
</span></span><span style=display:flex><span>        VStack {
</span></span><span style=display:flex><span>            List {
</span></span><span style=display:flex><span>                ForEach(categoryGroups, id: <span style=color:#960050;background-color:#1e0010>\</span>.id) { group <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>                    Text(group.name)
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                    ForEach(group.categories, id: <span style=color:#960050;background-color:#1e0010>\</span>.id) { category <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>                        Text(category.name)
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>So basically I have this <code>CategoryGroup</code> entity that contains a <code>name</code> field
which is a simple string (so far so good, if I just put it up until the
<code>Text(group.name)</code> it works), but it also contains the <code>categories</code> field which
is a list of the <code>Category</code> entity. Accessing the <code>categories</code> field gives us
the error above.</p><p>I wasn&rsquo;t able to find much online about <em>why</em> this happens, but my guess is that
<code>ForEach</code> enumerates each of the elements of the entity using <code>objectAtIndex</code>,
however unless you&rsquo;ve checked the <code>Ordered</code> option in the <code>Arrangement</code> section of your schema, this will fail with this error since (again, I&rsquo;m guessing) the method will not be available. Don&rsquo;t you love
it when something that could have been a compile error is instead a <em>right in your face</em>
error?</p><p>So in order to solve this, enter in your CoreData model and go to the entity
that contains the To Many relationship with the other entity, in my case that&rsquo;s the
<code>CategoryGroup</code> entity that contains a To Many relationship to <code>Category</code>. Select
the relationship itself and on the right sidebar check the &ldquo;Ordered&rdquo; option:</p><p><img src=/blog/img/swiftui-coredata-objectAtIndex-error/swiftui-coredata-objectAtIndex-error_2022-06-21-22-54-49.png alt="Xcode showing the Ordered option in the right sidebar"></p><p>That will hopefully make it work. See you next time Swift decides to give us
another nice head scratch!</p></div></div><div class="post on-list"><h1 class=post-title><a href=https://sleepyfran.github.io/blog/posts/swiftui-formatting/>Formatters in SwiftUI</a></h1><div class=post-meta><span class=post-date>2022-06-21</span>
<span class=post-author>:: sleepyfran</span></div><span class=post-tags>#<a href=https://sleepyfran.github.io/blog/tags/programming/>programming</a>&nbsp;
#<a href=https://sleepyfran.github.io/blog/tags/swift/>swift</a>&nbsp;
#<a href=https://sleepyfran.github.io/blog/tags/swiftui/>swiftui</a>&nbsp;</span><div class=post-content><p>One of the most common issues I had with SwiftUI were always related to handling
different data types inside of the <code>Text</code> or <code>TextField</code> controls, specially
when handling numbers like <code>Decimal</code> where you&rsquo;d need to manually specify a
<code>NumberFormatter</code> with the correct settings and yada yada yada.</p><p>Luckily since iOS 15, iPadOS 15 and macOS 12 it&rsquo;s possible to simply pass a format to the <code>Text</code> and <code>TextField</code> controls and it takes care of displaying it
correctly by itself. This means that we can, for example, create a text field
that formats itself to display the amount in US Dollars with this little amount
of code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>SwiftUI</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>ContentView</span>: View {
</span></span><span style=display:flex><span>    @State <span style=color:#66d9ef>var</span> accountBalance: Decimal = <span style=color:#ae81ff>1500.24</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> body: some View {
</span></span><span style=display:flex><span>        VStack(alignment: .center) {
</span></span><span style=display:flex><span>            TextField(
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;Enter your balance&#34;</span>,
</span></span><span style=display:flex><span>                value: <span style=color:#960050;background-color:#1e0010>$</span>accountBalance,
</span></span><span style=display:flex><span>                format: .currency(code: <span style=color:#e6db74>&#34;USD&#34;</span>)
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>            .textFieldStyle(.roundedBorder)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Which displays this:
<img src=/blog/img/swiftui-formatting/swiftui-formatting_2022-06-21-22-26-30.png alt="iOS Simulator displaying a TextField control formatting the content in US Dollars"></p><p>And of course it supports all the currency codes that you could originally put
on a <code>NumberFormatter</code>, as easy as changing <code>USD</code> for <code>GBP</code> and we got ourselves
a nice looking Text Field that displays its content in Pounds:</p><p><img src=/blog/img/swiftui-formatting/swiftui-formatting_2022-06-21-22-26-56.png alt="iOS Simulator displaying a TextField control formatting the content in Pounds"></p><p>This also works by using the <code>format</code> parameter in a <code>Text</code> control:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>SwiftUI</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>ContentView</span>: View {
</span></span><span style=display:flex><span>    @State <span style=color:#66d9ef>var</span> accountBalance: Decimal = <span style=color:#ae81ff>1500.24</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> body: some View {
</span></span><span style=display:flex><span>        VStack(alignment: .center) {
</span></span><span style=display:flex><span>            Text(accountBalance,format: .currency(code: <span style=color:#e6db74>&#34;USD&#34;</span>))
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><img src=/blog/img/swiftui-formatting/swiftui-formatting_2022-06-21-22-25-53.png alt="iOS Simulator displaying a Text control formatting the content in US Dollars"></p><p>And these shortcuts are just for the base case, if you require any more configuration
on top of that you can use the <code>FormatStyle</code> directly and configure it to your
liking. For example, this next snippet shows the amount formatted for US Dollars
always displaying the sign and scaling the amount 4 times:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>SwiftUI</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>ContentView</span>: View {
</span></span><span style=display:flex><span>    @State <span style=color:#66d9ef>var</span> accountBalance: Decimal = <span style=color:#ae81ff>1500.24</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> body: some View {
</span></span><span style=display:flex><span>        VStack(alignment: .center) {
</span></span><span style=display:flex><span>            Text(
</span></span><span style=display:flex><span>                accountBalance,
</span></span><span style=display:flex><span>                format: Decimal.FormatStyle.Currency(code: <span style=color:#e6db74>&#34;USD&#34;</span>)
</span></span><span style=display:flex><span>                    .sign(strategy: .always())
</span></span><span style=display:flex><span>                    .scale(<span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><img src=/blog/img/swiftui-formatting/swiftui-formatting_2022-06-21-22-25-12.png alt="iOS Simulator showing a Text control formatting as explained above"></p><p>There&rsquo;s a lot of other formatters available, so simply add <code>format</code> to your control
and try all of them out!</p></div></div><div class="post on-list"><h1 class=post-title><a href=https://sleepyfran.github.io/blog/posts/hello-world/>Hello world!</a></h1><div class=post-meta><span class=post-date>2022-06-20</span>
<span class=post-author>:: sleepyfran</span></div><div class=post-content><p>Are we live? Mic check, mic check. So I&rsquo;m just starting to re-learn Swift and SwiftUI and since Apple&rsquo;s documentation is lacking to say the least I&rsquo;ve decided to start writing this little blog to keep everything I&rsquo;m finding. The idea is to write short articles straight to the point on how to do X and Y. Sort of like a &ldquo;knowledge graph&rdquo; but without the graph ðŸ™‚</p></div></div><div class=pagination><div class=pagination__buttons></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme based on <a href=https://github.com/panr/hugo-theme-terminal>Terminal</a></span>
<span>:: Code available on <a href=https://github.com/sleepyfran/blog>GitHub</a></span></div></div></footer><script src=https://sleepyfran.github.io/blog/assets/main.js></script>
<script src=https://sleepyfran.github.io/blog/assets/prism.js></script></div></body></html>